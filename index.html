<html>
<head>
  <title>IronThronePowers map</title>
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/leaflet.css">
  <link rel="stylesheet" href="css/page.css">
  <script src="js/jquery.js"></script>
  <script src="js/bootstrap.js"></script>
  <script src="js/leaflet.js"></script>
  <script src="js/markers.js"></script>
  <script>
  </script>
  </head>
<body>
  <div id="header">
    <div id="link" onClick='window.location.href="https://reddit.com/r/ironthronepowers"'></div>
  </div>  q
  <div id="toolbar">
    <button type="button" class="btn btn-block" style="background-color:#f0c61d" onClick="toggleSLLayer()">Toggle SL</button>
	<button type="button" class="btn btn-block" style="background-color:#daed0e" onClick="toggleCLLayer()">Toggle CL</button>
	<button type="button" class="btn btn-block" style="background-color:#5bc0de" onClick="toggleValeLayer()">Toggle Vale</button>
	<button type="button" class="btn btn-block" style="background-color:#b8b2b5" onClick="toggleNorthLayer()">Toggle North</button>
	<button type="button" class="btn btn-block" style="background-color:#da6913" onClick="toggleDorneLayer()">Toggle Dorne</button>
	<button type="button" class="btn btn-block" style="background-color:#4ca20b" onClick="toggleReachLayer()">Toggle Reach</button>
	<button type="button" class="btn btn-block" style="background-color:#323232" onClick="toggleIILayer()">Toggle II</button>
	<button type="button" class="btn btn-block" style="background-color:#c21919" onClick="toggleWestLayer()">Toggle West</button>
	<button type="button" class="btn btn-block" style="background-color:#2c3695" onClick="toggleRLLayer()">Toggle RL</button>
	<button type="button" class="btn btn-block" style="background-color:#8333ef" onClick="toggleNonWesterosLayer()">Toggle Rest</button>
    <hr>
	<button id="btn-line" type="button" class="btn btn-block btn-default" data-drawing="no" style="color:#000" onClick="add_line()">Draw Line</button>
	<button id="btn-line" type="button" class="btn btn-block btn-default" style="color:#000" onClick="clear_lines()">Clear Lines</button>  
	  <!-- <textarea class="form-control" id="text" style="resize:none;font-size:10px;height:50%"></textarea> -->
  </div>
  <div id="map"></div>
  <script src="js/init_map.js"></script>  
  <script>
	var polylines = []
	var currentLine;
	function add_line(){
		btn = $("#btn-line")
		if(btn.data('drawing') == "no"){
			btn.html("Stop drawing line")
			btn.data("drawing","yes")
			currentLine = L.polyline([], {color: prompt("Enter Color")}).addTo(map);
			polylines.push(currentLine);
			map.on('click', onMapClick);
			
		}
		else{
			btn.html("Draw line")
			btn.data("drawing","no")
			map.off('click',onMapClick);	
		}
	}

	function clear_lines(){
		if(confirm("Are you sure?"))
			for(var i = 0; i < polylines.length; ++i){
				map.removeLayer(polylines[i])
			}	
	}
	
	/*This function gives you Lat Long of what you click on */
	function onMapClick(e) {
	
		//if(confirm("ADD MARKER HERE=?")){
		//	var mrk = prompt("Marker (SL,CL,Dorne,II,North,NotWesteros,RL,TrueNorth,Vale,Wall,West):")
		//	var txt = prompt("Text")
			m_icon = L.icon({iconUrl: 'img/marker/transparent.png',iconSize: [32, 74]})
			mark = new L.Marker([e.latlng.lat, e.latlng.lng], {icon: m_icon})//.bindPopup(txt);
			map.addLayer(mark)
			currentLine.addLatLng(mark.getLatLng())	
		//	$("#text").val($("#text").val()+"["+e.latlng.lat+","+e.latlng.lng+","+mrk+",\""+txt+"\"],\n")

	//	}

	};
  </script>
</body>
</html>
